using System;
using System.Text;
using System.Collections.Generic;
using Microsoft.VisualStudio.TestTools.UnitTesting;
using System.Windows.Shapes;
using ImageEditorSpace;
using System.Windows.Controls;

namespace ImageEditorUnitTest
{

    [TestClass]
    public class PenTest
    {
        private Pen _pen;
        private PrivateObject _target;
        private const double TEST_X1 = 0;
        private const double TEST_X2 = 0;
        private const double TEST_Y1 = 50;
        private const double TEST_Y2 = 50;

        [TestInitialize()]
        public void TestInitialize()
        {
            _pen = new Pen();
            _target = new PrivateObject(_pen);
        }

        [TestMethod]
        public void TestDraw()
        {
            _pen.Draw(TEST_X1, TEST_X2, TEST_Y1, TEST_Y2);
            List<Line> lineList = (List<Line>)_target.GetFieldOrProperty("lines");
            Assert.AreEqual(1, lineList.Count);
        }

        [TestMethod]
        public void TestGetCanvas()
        {
            _pen.Draw(TEST_X1, TEST_X2, TEST_Y1, TEST_Y2);
            List<Line> lineList = (List<Line>)_target.GetFieldOrProperty("lines");
            Assert.AreEqual(1, lineList.Count);
            Canvas canvas1 = _pen.GetCanvas();
            Canvas canvas2 = (Canvas)_target.GetFieldOrProperty("outputCanvas");
            Assert.AreSame(canvas1, canvas2);
            Assert.AreEqual(canvas1, canvas2);
        }

        [TestMethod]
        public void TestGetType()
        {
            ToolType Tool = _pen.GetToolType();
            Assert.AreEqual(ToolType.Pen, Tool);
        }
    }
}
